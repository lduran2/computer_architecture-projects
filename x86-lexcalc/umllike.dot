/* Note that this is not exactly a UML diagram.
   Rather, it treats functions as classes
   with their parameters as public fields.
 */

digraph x86calc {
    /* nodes */
    node [
        shape = "record",
        fontname = "Verdana,DejaVu Sans,Bitstream Vera Sans"
    ];

    _start [
        label = "{\N|}"
    ];

    END [
        label = "{\N|}"
    ];

    PROMPT_STR_INPUT [
        label = "{\N|+ rdi : char **\l+ rsi : char *\l+ rdx : int\l+ rcx : int *\l+ rax : char *}"
    ];

    NEXT_TOKEN [
        label = "{\N|+ rdi : char **\l+ rcx : int *\l+ rax : char *}"
    ];

    WRITELN [
        label = "{\N|+ rdi : char *\l+ rdx : int\l}"
    ];

    PROMPT_INPUT [
        label = "{\N|+ rdi : char *\l+ rsi : char *\l+ rdx : int\l+ rcx : int\l}"
    ];

    SEEKNE [
        label = "{\N|+ rdi : char **\l+ rax : void (*)(char rsi)\l}"
    ];

    SEEKNE_rax [
        label = "{&laquo;pointer&raquo;\nSEEKNE::rax|+ rsi : char\l}"
    ];



    ISSPACE [
        label = "{\N|+ rsi : char\l}"
    ];



    STRREV [
        label = "{\N|+ rdi : char *\l+ rsi : char *\l+ rdx : int\l}"
    ];

    STRREV_POP_INIT [
        label = "{\N|+ rdi : char *\l+ rdx : int\l}"
    ];
 
    EXIT_END_OF_INPUT [
        label = "{\N|}"
    ];
    sys_exit [
        shape = "doublecircle"
    ];

    /* edges */
    _start -> PROMPT_AND_GET_STRINGS [
        style="dashed", arrowhead="vee"
    ];
    _start -> END [
        dir="back", arrowtail="odiamond"
    ];

    END -> sys_exit [
        style="dashed", arrowhead="vee"
    ];

    PROMPT_AND_GET_STRINGS -> PROMPT_STR_INPUT [
        style="dashed", arrowhead="vee",
        headlabel="2  "
    ];

    PROMPT_STR_INPUT -> PROMPT_INPUT [
        style="dashed", arrowhead="vee"
    ];
    PROMPT_STR_INPUT -> NEXT_TOKEN [
        style="dashed", arrowhead="vee"
    ];

    EXIT_END_OF_INPUT -> sys_exit [
        style="dashed", arrowhead="vee"
    ];

    NEXT_TOKEN -> ISSPACE [
        style="dashed", arrowhead="vee"
    ];
    NEXT_TOKEN -> EXIT_END_OF_INPUT [
        dir="back", arrowtail="odiamond"
    ];
    NEXT_TOKEN -> SEEKNE [
        style="dashed", arrowhead="vee"
    ];

    SEEKNE -> SEEKNE_rax [
        style="dashed", arrowhead="vee"
    ];

    ISSPACE -> SEEKNE_rax [
        style="dashed", arrowhead="empty"
    ];

    STRREV -> STRREV_POP_INIT [
        dir="back", arrowtail="odiamond"
    ];

}